=== Bg Orthodox Calendar ===

Contributors: VBog

Donate link: http://bogaiskov.ru/about-me/donate/

Tags: calendar, orthodoxy, christianity, календарь, православие, христианство, месяцеслов, именины, браковенчание, ορθοδοξία, χριστιανισμός

Requires at least: 3.0.1

Tested up to: 4.7.2

Stable tag: trunk

License: GPLv2

License URI: http://www.gnu.org/licenses/gpl-2.0.html


Orthodox calendar on your site.


== Description ==

Plugin allows you to display the window with the Orthodox calendar.

Details in Russian only:

[Плагин](http://bogaiskov.ru/plugin-orthodox-calendar/) позволяет вывести на экран окно с православным календарем на год. 
Для каждого дня года во всплывающей подсказке высвечиваются: дата по старому стилю, праздники по типикону (от двунадесятых до вседневных), памятные даты, дни поминовения усопших, дни почитания икон, посты и сплошные седмицы.
Светлое христово воскресение выделено белым цветом на красном фоне, двунадесятые и великие праздники – красным цветом, кроме того красным цветов отмечены воскресные дни, дни особого поминовения усопших – синим цветом. 
Постные дни (многодневные и однодневные посты, а также среды и пятницы) отмечены серым фоном.
Плагин позволяет для каждой даты выбрать дальнейшее действие перейти на официальный календарь РПЦ или сайта Православие.Ru, вывести на экран Богослужебные указания, показать этот день в календаре и выбрать имя по Месяцеслову. 
С помощью нашего календаря существует возможность выбора имени новорожденному в соответствии с традицией по Месяцеслову.
При желании можно отметить на календаре дни браковенчаний.

Используйте настройки, чтобы изменить цветовую палитру некоторых элементов календаря. 


Чтобы вставить в текст статьи кнопку для вызова календаря используется шорт-код  `[ortcal_button val=' Календарь на год ']`

Вы также можете встроить календарь на год на страницу, используя шорт-код `[ortcal_button val=' Календарь на год ']`


= Информация о дне =

Шорт-код `[dayinfo]` позволяет вывести в тексте заметки/страницы информацию о событиях указанного дня из православного календаря.

В шорт-коде могут использоваться следующие параметры:

* **day**, **month**, **year** - день, месяц и год по Григорианскому календарю, по умолчанию - данные текущего дня,
* **date** - формат отображения даты по Григорианскому календарю (см. формат PHP даты), по умолчанию 'l, j F Y г. ',
* **old** - формат отображения даты по Юлианскому календарю, по умолчанию '(j F ст.ст.)',
* **sedmica** - вкл.('on') или выкл.('off') отображение названия Седмицы (Недели) по годичному кругу богослужений, или только Недели ('nedela'), по умолчанию 'on',
* **memory** - вкл.('on') или выкл.('off') отображение памятных дней, по умолчанию 'on',
* **honor** - вкл.('on') или выкл.('off') отображение дней поминовения усопших, по умолчанию 'on',
* **holiday** - отображать праздники до указанного уровня значимости, по умолчанию = 7. Существует 7 уровней значимости православных праздников:

 - 0 - СВЕТЛОЕ ХРИСТОВО ВОСКРЕСЕНИЕ
 - 1 - ДВУНАДЕСЯТЫЕ ПРАЗДНИКИ
 - 2 - Великие праздники
 - 3 - Средние бденные праздники
 - 4 - Средние полиелейные праздники
 - 5 - Малые славословные праздники
 - 6 - Малые шестиричные праздники
 - 7 - Вседневные праздники. Cовершается служба, не отмеченная в Типиконе никаким знаком

Если, например, указан уровень `holiday=4`, то будут отображаться: Пасха, двунадесятые, великие, средние бденные и полиелейные праздники. Если `holiday=7` - все праздники.

* **img** - вкл.('on') или выкл.('off') отображение соответствующего знака Типикона при отображении названия праздника, по умолчанию 'on',
* **hosts** - вкл.('on') или выкл.('off') отображение Соборов святых, день памяти, которых приходится на эту дату, по умолчанию 'off',
* **saints** - вкл.('on') или выкл.('off') отображение имен святых, день памяти, которых приходится на эту дату, по умолчанию 'off',
* **martyrs** - вкл.('on') или выкл.('off') отображение имен исповедников и новомучеников российских, день памяти, которых приходится на эту дату, по умолчанию 'off',
* **icons** - вкл.('on') или выкл.('off') отображение названий икон Богородицы, день памяти, которых приходится на эту дату, по умолчанию 'off',
* **posts** - вкл.('on') или выкл.('off') отображение постных дней или светлых седмиц, по умолчанию 'off',
* **noglans** - вкл.('on') или выкл.('off') отображение информации о том, в что в этот день браковенчание не совершается, по умолчанию 'off',
* **readings** - вкл.('on') или выкл.('off') отображение Апостольских и Евангельских чтений и Псалтири с комментариями, по умолчанию 'off',

 - если **readings='M'**, отображаются только чтения на Утрене,
 - если **readings='A'**, отображаются только Апостольские чтения на Литургии,
 - если **readings='G'**, отображаются только Евангельские чтения на Литургии,
 - если **readings='AG'**, отображаются только Апостольские и Евангельские чтенияна Литургии, 
 - если **readings='MAG'**, отображаются только Апостольские и Евангельские чтения на Утрене и на Литургии, 
 - если **readings='E'**, отображаются только чтения на Вечерне,
 - если **readings='H'**, отображаются только чтения на часах,
 - если **readings='F'**, отображаются только чтения на Праздники,
 - если **readings='P'**, отображаются только чтения Псалтири,
 - если **readings='N'**, чтения Нового Завета (то же, что и 'on', но без Псалтири),
 - в остальных случаях ВСЕ тексты, указанные на заданный день с комментариями. 
 
* **links** - отображение ссылок и цитат;  выкл.('off') - ничего не отображать, вкл.('on' или '') - отображать ссылки (по умолчанию), в остальных случаях отображать цитаты: 

 + ’book’, то отображаются наименование книги, заголовки глав и стихи, каждый отдельным абзацем, с указанием его номера.
 + ’verses’, то отображаются только стихи, каждый отдельным абзацем, с указанием номера главы и номера стиха.
 + ’b_verses’, то отображаются только стихи, каждый отдельным абзацем, с указанием короткого названия книги, номера главы и номера стиха.
 + ’t_verses’, то отображаются наименование книги и стихи, каждый отдельным абзацем, с указанием номера главы и номера стиха.
 + ’quote’, то отображаются только стихи без деления их на абзацы.

Для параметров **hosts**, **saints**, **martyrs**, **icons**, **posts**, **noglans** и **readings** в качестве значения Вы можете также указать любую строку, которая будет отображаться на экране в качестве заголовка соответствующих данных.
Для дополнительной разметки текста в можете использовать теги HTML.
Например, `saints='<b>День памяти святых:</b><br>'` выведет на экран жирным шрифтом заголовок перед списком святых, день памяти, которых приходится на указанную дату. При этом список будет отображаться с новой строки.

ВНИМАНИЕ! Чтобы отображались ссылки или цитаты необходимо, чтобы в Ваш WordPress был установлен плагин [Bg Bible References](https://wordpress.org/plugins/bg-biblie-references/) версии не ниже 2.10.

Если в параметре **day** указать число со знаком “+” или “-”, шорт-код будет воспринимать это число как смещение от текущей даты, соответственно вперед (“+“) или назад (“-“). 
Если в параметре **day** указать 'post', то в качестве даты, будет принята дата публикации поста/страницы. 
Вы можете создать собственную функцию, возвращающую значение даты и указать имя этой функции в качестве значения параметра **day** в шорт-кодах. 
Эта возможность может применяться для совместимости с другими плагинами.
Пользовательская функция должна возвращать значение даты в соответствии с шаблоном, заданным в качестве аргумента, аналогично php-функции [date( string $format )](http://php.net/manual/ru/function.date.php) : `string get_custom_date ( string $format )`
Во всех этих случаях значения параметров **month** и **year** будут проигнорированы.

Задание в параметре **day** значения ’get’, указывает на необходимость получить дату дня из командной строки браузера. Например:

https://bogaiskov.ru/ortcal/?date=2015-10-31,

где **date** – дата в формате год-месяц-день по новому стилю. 
Эта возможность может использоваться вместе с шорт-кодом `[ortcal month='10' year='2015']`, который выводит на экран календарь на месяц, позволяющий выбрать требуемую дату с последующим отображением развернутой информации о дне на странице блога.
Параметры шорт-кода **month** и **year** определяют месяц и год, которые будут отображены в календаре по умолчанию (если не заданы соответствующие параметры в командной строке). 
Если **month** и **year** не заданы, то отображается текущий месяц.

Для оформления отображаемой информации можно использовать следующие стили:

* *bg_ortcal_date* - даты по Григорианскому календарю,
* *bg_ortcal_old* - даты по Юлианскому календарю,
* *bg_ortcal_sedmica* - названия Седмицы (Недели) по годичному кругу богослужений,
* *bg_ortcal_sunday* - дополнительный класс, используемый вместе с классами *bg_ortcal_date*, *bg_ortcal_old* и *bg_ortcal_sedmica* для обозначения воскресного дня,
* *bg_ortcal_memory* - памятных дней, 
* *bg_ortcal_honor* - дней поминовения усопших, 
* *bg_ortcal_great* - Пасхи, двунадесятых и великих праздников,
* *bg_ortcal_middle* - Средних праздников,
* *bg_ortcal_small* - Малых и вседневных праздников,
* *bg_ortcal_hosts* - Соборов святых, день памяти, которых приходится на эту дату,
* *bg_ortcal_saints* - имен святых, день памяти, которых приходится на эту дату,
* *bg_ortcal_martyrs* - имен исповедников и новомучеников российских, день памяти, которых приходится на эту дату, 
* *bg_ortcal_icons* - названий икон Богородицы, день памяти, которых приходится на эту дату, 
* *bg_ortcal_posts* - постных дней или светлых седмиц,
* *bg_ortcal_noglans* - информации о том, в что в этот день браковенчание не совершается,
* *bg_ortcal_readings* - Апостольских и Евангельских чтений.


Вспомогательные шорт-коды `[prev_day]` и `[next_day]` могут использоваться на одной странице совместно с шорт-кодом `[dayinfo day='get']` для отображения данных предыдущего или следующего дня.
По умолчанию шорт-коды  `[prev_day]` и `[next_day]` выводят на экран фразы `'&#9204; Предыдущий день'` и `'Следующий день &#9205;'` с ссылками на соответствующую страницу.
Фраза может быть изменена в параметре **title**.

Для задания внешнего вида ссылок можно использовать описание классов *bg_ortcal_prevday* и *bg_ortcal_nextday*.


Шорт-код `[oldstyle]` выводит на экран дату по Юлианскому календарю (по старому стилю). Параметры:

* **day**, **month**, **year** - день, месяц и год по Григорианскому календарю, по умолчанию - данные текущего дня,
* **old** - формат отображения даты по Юлианскому календарю, по умолчанию 'j F Y г. по ст.ст.'. 

**ВНИМАНИЕ!** Для отображения дня недели используйте в строке формата символы l (строчное ‘L‘) - для полного наименования дня недели и  D – для сокращенного наименования дня недели  (2 символа). 
Порядковый номер дня недели (N, w) отображается не корректно! Не используйте этот шорт-код для его отображения.


Шорт-код `[sedmica]` выводит на экран название Седмицы (Недели) по годичному кругу богослужений, на которую приходится указанный день. Параметры:

* **day**, **month**, **year** - день, месяц и год по Григорианскому календарю, по умолчанию - данные текущего дня.


Для указания Евангелие дня можно использовать короткий шорткод `[readings]` . Параметры:

* **day**, **month**, **year** - день, месяц и год по Григорианскому календарю, по умолчанию – данные текущего дня,
* **readings** - отображение Апостольских и Евангельских чтений, по умолчанию ‘G‘,
* **links** - отображение ссылок и цитат; по умолчанию - `links=’t_verses’`. 


Для отображения всей информации о дне можно использовать его короткий шорткод  `[dayinfo_all]`. Параметры:

* **day**, **month**, **year** - день, месяц и год по Григорианскому календарю, по умолчанию – данные текущего дня.


= Календарь на месяц =

Шорт-код календарь на месяц `[ortcal month='10' year='2015']`, позволяет выбрать требуемую дату в Православном календаре с последующим отображением развернутой информации о дне на странице блога. 

При щелчке мышкой по дате в календаре осуществляется переход на страницу блога, указанную в настройках плагина.
На этой странице должен быть размещен шорт-код `[dayinfo day='get']`.

Для тонкой настройки внешнего вида календаря используйте класс *bg_moncal*.


= Ближайшие события =

Шорт-код `[upcoming_events]` позволяет вывести в тексте заметки/страницы информацию о ближайших событиях из православного календаря. Параметры: 

* **numdays** - количество дней поиска ближайших событий,
* остальные параметры как в шорткоде `[dayinfo]`, при этом параметры **day**, **month**, **year** - игнорируются.

По умолчанию шорт-код `[upcoming_events]` отображает только двунадесятые и великие праздники, а также дни поминовения усопших в ближайшие две недели (14 дней). 


= Расписание богослужений =

Шорт-код `[schedule]...[/schedule]` преобразует расписание богослужений, заданное в простой текстовой форме и заключенное между тегами шорт-кода, в таблицу, добавляя описания дней и наименования седмиц.

* **period** - период группировки дней: 'm' - месяц, 's' - седмица,
* остальные параметры как в шорткоде `[dayinfo]`, при этом параметры **day**, **month**, **year** - игнорируются, а параметр sedmica по умолчанию = 'nedela'.

Каждое событие в расписание должно иметь следующий формат:

`dd-mm-yyyy hh:mm Название_события`

где *dd-mm-yyyy* - дата события, *hh:mm* - время начала события, *Название_события* - произвольный текст.

Если дата и/или время не заданы или заданы неверно, событие не отображается.

Чтобы задать событие на целый день, укажите вместо времени начала события: *88:88*.

Классы для оформления расписания:

* *bg_ortcal_schedule* - общий класс контейнера с расписанием,
* *bg_ortcal_week* - класс ячейки с отображением названия седмицы,
* *bg_ortcal_day* - класс ячейки с отображением информации о дне,
* *bg_ortcal_time* - класс ячейки с отображением времени события,
* *bg_ortcal_event* - класс ячейки с отображением названия событи

Вы можете добавлять события в базу данных, используя [пользовательский XML-файл данных](http://wp.me/p4B8xz-nM "Подробнее").

= Внутренний кеш плагина =

Для ускорения работы плагина используется внутренний кеш данных, построенный на базе WP-функций `set_transient()/get_transient()`.
Будьте готовы к тому, что в вашей базе данных появятся более 800 новых записей.

Кеш будет обновляться при каждом обновлении плагина.
Он также будет сброшен при обновлении настроек плагина.

Для ускорения отображения информации мы также настоятельно рекомендуем использовать один из известных плагинов для кеширования.
Например, [WP Super Cache](https://ru.wordpress.org/plugins/wp-super-cache/) или  [W3 Total Cache](https://ru.wordpress.org/plugins/w3-total-cache/).

== Installation ==

1. Upload 'bg-orthodox-calendar' directory to the '/wp-content/plugins/' directory.
2. Activate the plugin through the 'Plugins' menu in WordPress.

== Frequently Asked Questions ==

= На всех ли темах WP работает плагин? =

Для нормальной работы плагина необходимо, чтобы в соответствии с WordPress Codex в файле **footer.php** Вашей темы WordPress непосредственно перед тегом `</body>` вызывалась функция **wp_footer()**;


== Screenshots ==

1. Окно календаря на год
2. Окно выбора имени новорожденному
3. Страница календаря на год (месяц, день).

== Changelog ==

= 0.13.1 =

* Исправлены некоторые баги.

= 0.13.0 =

* Интернационализация плагина.

= 0.12.1-5 =

* Исправлены некоторые баги.
* Добавлена ссылка на календарь Азбука веры.
* Включены имена древних святых, подвизавшихся в западных странах (журнал № 14).

= 0.12.0 =

* Новый механизм внутреннего кеш.
* Добавлен шорт-код `[ortcal_year]` - вывод на страницу календаря на год.
* Исправлены некоторые баги.

= 0.11.7 =

* Соборы святых выделены в отдельную категорию в базе данных (type=16).
* Чтобы указать в БД событие в ближайшее воскресенье укажите s_month=-4 и s_date=7.

= 0.11.6 =

* Обновлена база данных календаря.
* Добавлены шорт-коды `[prev_day]` и `[next_day]`.
* Исправлен баг при выводе чтений в регионах, использующих летнее время.

= 0.11.5 =

* Добавленны новые данные и исправлены некоторые ошибки в календаре.

= 0.11.4 =

* Можно установить часовой пояс, установленный в настройках WP.

= 0.11.3 =

* Добавлена опция выбора часового пояса.
* Исправлены незначительные баги.

= 0.11.2 =

* Исправлен незначительный баг при обращении к Pravoslavie.Ru.

= 0.11.1 =

* Параметр **sedmica** может принимать значение 'nedela' - отображать наименование только недели (воскресения).
* Добавлены параметры в шорт-код `[schedule]`

= 0.11.0 =

* Добавлен шорт-код `[schedule]`.

= 0.10.5-RC =

* Исправлены незначительные ошибки.

= 0.10.4-RC =

* Исправлена ошибка инициализации начальных параметров плагина.

= 0.10.2-RC =

* Исправлена ошибка определения крещенской отступки при расчете Евангельских чтений.

= 0.10.0-RC =

* Добавлен пользовательский тип данных 999 - любые данные, связанные с календарем.
* В базу данных добавлены поля link (ссылка на внешний ресурс) и discription (подробное описание). Отображение ссылок для всех типов данных кроме чтений.
* Возможность отключить стандартную базу данных с использованием только пользовательского XML-файла.
* Переименованы PHP и JS функции и названия CSS-классов для обеспечения уникальности их имен.
* Исправлены ошибки и оптимизированы некоторые алгоритмы.

= 0.9.4 =

* Совместимость в версией 3.11 плагина Bg Bible References.

= 0.9.3 =

* Добавлена настройка Z-index для всплывающего окна календаря.
* Исправлены ошибки.

= 0.9.2 =

* Исправлены мелкие ошибки.

= 0.9.1 =

* Исправлены мелкие ошибки.

= 0.9.0 =

* Добавлен шорт-код `[ortcal]`, который выводит на экран календарь на месяц, позволяющий выбрать требуемую дату с последующим отображением развернутой информации о дне на странице блога.
* Задание в параметре day шорт-кода `[dayinfo]` значения ’get’, указывает на необходимость получить дату дня из командной строки браузера.
* Ускорение работы алгоритма календаря за сет кеширования результатов расчета через встроенные функции WordPress. Большое спасибо [Maxvgi](https://github.com/maxvgi).
* Переработан алгоритм вывода чтений на экран.
* Исправлены некоторые ошибки в базе данных.

= 0.8.0 =

* Добавлены чтения "под зачало".
* Переработан формат вывода чтений на экран.
* Если readings='N', чтения Нового Завета (то же, что и 'on', но без Псалтири)

= 0.7.8 =

* Исправлены ошибки в БД.

= 0.7.7 =

* Исправлены ошибки.

= 0.7.6 =

* Исправлены ошибки.

= 0.7.5 =

* Добавлена настройка элементов всплывающего меню календаря.

= 0.7.4 =

* Исправлены ошибки.

= 0.7.3 =

* Перереботан алгоритм загрузки данных. Календарь загружается быстрее.
* Вы можете выбрать метод загрузки XML-файла в настройках плагина.

= 0.7.2 =

* Вы можете создать собственную функцию, возвращающую значение даты и указать имя этой функции в качестве значения параметра day в шорт-кодах. (Для совместимости с другими плагинами).

= 0.7.1 =

* Если в параметре шорт-кодов day указать 'post', то в качестве даты, будет принята дата публикации поста/страницы. 

= 0.7 =

* Теперь параметр шорт-кодов memory отображает только памятные дни, добавлен параметр honor - отображение дней поминовения усопших.
* Добавлен шорт-код [ upcoming_events ] - информация о ближайших событиях из православного календаря.

= 0.6 =

* Пользовательский XML-файл данных / Custom XML-file with data

= 0.5.2 =

* Добавлены чтения Псалтири / Added reading of the Psalter

= 0.5.1 =

* Исправлены ошибки / Fixed bugs

= 0.5 =

* Добавлены Апостольские и Евангельские чтения / Added Apostolic and Gospel Readings
* Дополнительные шорт-коды

= 0.4 =

* Добавлены шорт-коды, позволяющие выводить информацию из православного календаря / Added short codes to display information from the Orthodox calendar
* Исправлены ошибки в базе данных / Fixed mistakes in database

= 0.3.1 =

* Исправлена ошибка в настройках CSS / Fixed error in CSS settings

= 0.3 =

* Добавлены настройки цвета рамки дней браковенчаний / Added settings of the frame color of Wedding Days

= 0.2.3 =

* Исправлена ошибка в настройках цвета фона Сегодня / Fixed error in background option of Today

= 0.2.2 =

* Изменения в настройках стилей / Changes in styles  

= 0.2 =

* Добавлены настройки цветов / Added color settings

= 0.1 =

* Плагин в режиме бета-тестирования / Plugin in beta testing mode


== Upgrade Notice ==

= 0.13 =

* Интернационализация плагина


== License ==

GNU General Public License v2

